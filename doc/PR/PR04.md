# PR#4: LINEãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ‘ãƒ¼ã‚µãƒ¼ã®å®Ÿè£…

## ğŸ“‹ æ¦‚è¦
LINEã®ãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.txtå½¢å¼ï¼‰ã‚’è§£æã—ã¦æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚å®Ÿéš›ã®LINE ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼ã«å¯¾å¿œã—ã€æ—¥ä»˜è¡Œã®è§£æã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡Œã®è§£æã€ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ã‚¹ã‚¿ãƒ³ãƒ—ãƒ»å†™çœŸã®é™¤å¤–å‡¦ç†ã‚’å«ã‚€åŒ…æ‹¬çš„ãªæ©Ÿèƒ½ã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚15ã®å˜ä½“ãƒ†ã‚¹ãƒˆã«ã‚ˆã‚Š97%ã®ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’é”æˆã—ã¦ã„ã¾ã™ã€‚

## ğŸ¯ ç›®çš„
- LINEãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ åŒ–
- æ—¥æœ¬èªã‚’å«ã‚€è¤‡é›‘ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ­£ç¢ºãªè§£æ
- ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„ç”»åƒãƒ‡ãƒ¼ã‚¿ã®é©åˆ‡ãªé™¤å¤–
- å‹å®‰å…¨ãªæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
- ä»•æ§˜æ›¸ï¼ˆSPEC.md section 5.1ï¼‰é€šã‚Šã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®å®Ÿç¾

## ğŸ”§ å¤‰æ›´å†…å®¹

### 1. app/services/__init__.py
- ã‚µãƒ¼ãƒ“ã‚¹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åˆæœŸåŒ–
- `LineMessageParser`ã¨`Message`ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- `__all__`ã«ã‚ˆã‚‹å…¬é–‹APIã®æ˜ç¤ºåŒ–

### 2. app/services/parser.py
#### Messageãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
- LINEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¾ã™ã‚‹æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿å‹
- **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**
  - `datetime` (datetime): ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡æ—¥æ™‚
  - `user` (str): é€ä¿¡ãƒ¦ãƒ¼ã‚¶ãƒ¼å
  - `content` (str): ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡
- `@dataclass`ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã‚ˆã‚‹ç°¡æ½”ãªå®Ÿè£…

#### LineMessageParserã‚¯ãƒ©ã‚¹
**ã‚¯ãƒ©ã‚¹å®šæ•°**
- `DATE_PATTERN`: æ—¥ä»˜è¡Œã®ãƒ‘ã‚¿ãƒ¼ãƒ³ `r"^(\d{4})/(\d{1,2})/(\d{1,2})\([æœˆç«æ°´æœ¨é‡‘åœŸæ—¥]\)$"`
- `META_PATTERNS`: é™¤å¤–å¯¾è±¡ã®ãƒ¡ã‚¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒªã‚¹ãƒˆï¼ˆ11ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
  - `[ã‚¹ã‚¿ãƒ³ãƒ—]`
  - `[å†™çœŸ]`
  - `[å‹•ç”»]`
  - `[ãƒ•ã‚¡ã‚¤ãƒ«]`
  - `[ã‚¢ãƒ«ãƒãƒ ]`
  - `[ãƒãƒ¼ãƒˆ]`
  - `[é€šè©±]`
  - `ãŒå‚åŠ ã—ã¾ã—ãŸã€‚`
  - `ãŒé€€å‡ºã—ã¾ã—ãŸã€‚`
  - `ãŒãƒ¡ãƒ³ãƒãƒ¼ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚`
  - `ãŒãƒ¡ãƒ³ãƒãƒ¼ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**

1. **`parse(file: TextIO) -> list[Message]`**
   - ãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ãƒ¡ã‚¤ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰
   - **å‡¦ç†ãƒ•ãƒ­ãƒ¼**
     1. ãƒ˜ãƒƒãƒ€ãƒ¼2è¡Œã¨ç©ºè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
     2. å„è¡Œã‚’é †æ¬¡å‡¦ç†
     3. æ—¥ä»˜è¡Œã‚’æ¤œå‡ºã—ã¦ç¾åœ¨æ—¥ä»˜ã‚’æ›´æ–°
     4. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡Œã‚’è§£æã—ã¦`Message`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆ
     5. æœ‰åŠ¹ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ 
   - **è¿”ã‚Šå€¤**: æ§‹é€ åŒ–ã•ã‚ŒãŸ`Message`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ãƒˆ

2. **`_parse_date_line(line: str) -> datetime | None`**
   - æ—¥ä»˜è¡Œï¼ˆ`YYYY/MM/DD(æ›œæ—¥)`å½¢å¼ï¼‰ã‚’è§£æ
   - **å‡¦ç†è©³ç´°**
     - æ­£è¦è¡¨ç¾ã«ã‚ˆã‚‹æ—¥ä»˜ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
     - `datetime()`ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã‚ˆã‚‹æ—¥ä»˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ
     - ä¸æ­£ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å ´åˆã¯`None`ã‚’è¿”å´
   - **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: `ValueError`ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦å®‰å…¨ã«å‡¦ç†ï¼ˆç„¡åŠ¹ãªæ—¥ä»˜ã®å ´åˆï¼‰

3. **`_parse_message_line(line: str, current_date: datetime) -> Message | None`**
   - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡Œï¼ˆã‚¿ãƒ–åŒºåˆ‡ã‚Šï¼‰ã‚’è§£æ
   - **å‡¦ç†è©³ç´°**
     1. ã‚¿ãƒ–æ–‡å­—ã§åˆ†å‰²ï¼ˆæ™‚åˆ»ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ï¼‰
     2. æ™‚åˆ»ã®æ­£è¦è¡¨ç¾ãƒãƒƒãƒãƒ³ã‚° `r"^(\d{1,2}):(\d{2})$"`
     3. å„ç¨®é™¤å¤–æ¡ä»¶ã®ãƒã‚§ãƒƒã‚¯
        - ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒç©ºï¼‰
        - ãƒ¡ã‚¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆã‚¹ã‚¿ãƒ³ãƒ—ã€å†™çœŸç­‰ï¼‰
        - ç©ºã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     4. `datetime`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆ
   - **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: 
     - ä¸æ­£ãªæ™‚åˆ»ï¼ˆ25:00ç­‰ï¼‰ã®å ´åˆã«`ValueError`ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦`None`ã‚’è¿”å´
     - æœ€ä½3è¦ç´ ï¼ˆæ™‚åˆ»ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ãŒå¿…è¦
   - **è¿”ã‚Šå€¤**: æœ‰åŠ¹ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å ´åˆã¯`Message`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€é™¤å¤–å¯¾è±¡ã®å ´åˆã¯`None`

### 3. tests/fixtures/sample_talk.txt
- ãƒ†ã‚¹ãƒˆç”¨ã®å®Ÿéš›ã®LINEãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ‡ãƒ¼ã‚¿
- **å†…å®¹**
  - 2æ—¥åˆ†ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ2024/08/01, 2024/08/02ï¼‰
  - 3ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆhogeå±±fugaå¤ªéƒã€piyoç”°ã€fooå­ï¼‰
  - é€šå¸¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚¹ã‚¿ãƒ³ãƒ—ã€å†™çœŸã‚’å«ã‚€
  - åˆè¨ˆ11ä»¶ã®æœ‰åŠ¹ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆé™¤å¤–å¯¾è±¡ã‚’é™¤ãï¼‰

### 4. tests/unit/test_parser.py
#### TestMessageã‚¯ãƒ©ã‚¹ï¼ˆ1ãƒ†ã‚¹ãƒˆï¼‰
- `test_create_instance`: `Message`ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ãƒ†ã‚¹ãƒˆ

#### TestLineMessageParserã‚¯ãƒ©ã‚¹ï¼ˆ14ãƒ†ã‚¹ãƒˆï¼‰

**æ­£å¸¸ç³»ãƒ†ã‚¹ãƒˆ**
1. `test_parse_standard_format`: æ¨™æº–çš„ãªãƒˆãƒ¼ã‚¯å±¥æ­´ã®è§£æ
2. `test_parse_with_fixture_file`: ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ãŸå®Ÿãƒ‡ãƒ¼ã‚¿è§£æ
3. `test_parse_multiple_dates`: è¤‡æ•°æ—¥ä»˜ã«ã¾ãŸãŒã‚‹ãƒ‡ãƒ¼ã‚¿ã®è§£æ
4. `test_parse_special_characters_in_username`: ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€å ´åˆ
5. `test_parse_special_characters_in_message`: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€å ´åˆ
6. `test_parse_multiline_message`: è¤‡æ•°è¡Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡¦ç†

**é™¤å¤–å‡¦ç†ãƒ†ã‚¹ãƒˆ**
7. `test_exclude_system_messages`: ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é™¤å¤–ç¢ºèª
8. `test_exclude_stamps_and_photos`: ã‚¹ã‚¿ãƒ³ãƒ—ãƒ»å†™çœŸã®é™¤å¤–ç¢ºèª

**å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ**
9. `test_parse_empty_file`: ç©ºãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†
10. `test_parse_only_one_message`: 1ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã®å‡¦ç†

**ç•°å¸¸ç³»ãƒ†ã‚¹ãƒˆ**
11. `test_parse_invalid_time_format`: ä¸æ­£ãªæ™‚åˆ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆ25:00ç­‰ï¼‰ã®å‡¦ç†
12. `test_parse_without_tab_separator`: ã‚¿ãƒ–åŒºåˆ‡ã‚ŠãŒãªã„è¡Œã®å‡¦ç†

**å†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ**
13. `test_parse_date_line`: æ—¥ä»˜è¡Œè§£æãƒ¡ã‚½ãƒƒãƒ‰ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
14. `test_parse_message_line`: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡Œè§£æãƒ¡ã‚½ãƒƒãƒ‰ã®å˜ä½“ãƒ†ã‚¹ãƒˆ

## âœ… ãƒ†ã‚¹ãƒˆçµæœ

å…¨ã¦ã®ãƒ†ã‚¹ãƒˆé …ç›®ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼š

- [x] **å˜ä½“ãƒ†ã‚¹ãƒˆ**: 15ãƒ†ã‚¹ãƒˆå…¨ã¦ãƒ‘ã‚¹
  ```bash
  $ pytest tests/unit/test_parser.py -v
  collected 15 items

  tests/unit/test_parser.py::TestMessage::test_create_instance PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_standard_format PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_with_fixture_file PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_exclude_system_messages PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_exclude_stamps_and_photos PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_multiple_dates PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_special_characters_in_username PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_special_characters_in_message PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_empty_file PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_only_one_message PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_invalid_time_format PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_without_tab_separator PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_date_line PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_message_line PASSED
  tests/unit/test_parser.py::TestLineMessageParser::test_parse_multiline_message PASSED

  ================ 15 passed in 0.31s ================
  ```

- [x] **ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸**: 97%é”æˆ
  ```bash
  $ pytest tests/unit/test_parser.py --cov=app/services --cov-report=term-missing

  Name                       Stmts   Miss  Cover   Missing
  --------------------------------------------------------
  app/services/__init__.py       2      0   100%
  app/services/parser.py        69      2    97%   145, 160
  --------------------------------------------------------
  TOTAL                         71      2    97%
  ```
  - æœªã‚«ãƒãƒ¼è¡Œï¼ˆ145, 160ï¼‰ã¯å®Ÿè³ªçš„ã«åˆ°é”ã—ãªã„é˜²è¡›çš„ã‚³ãƒ¼ãƒ‰
    - 145è¡Œç›®: ãƒ¡ã‚¿ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢ï¼ˆå®Ÿéš›ã«ã¯ãã®å‰ã®æ¡ä»¶ã§é™¤å¤–ã•ã‚Œã‚‹ï¼‰
    - 160è¡Œç›®: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç©ºã®å ´åˆã®ãƒã‚§ãƒƒã‚¯ï¼ˆæ—¢ã«stripã§é™¤å¤–æ¸ˆã¿ï¼‰

- [x] **å‹ãƒã‚§ãƒƒã‚¯ï¼ˆmypyï¼‰**: ã‚¨ãƒ©ãƒ¼ãªã—
  ```bash
  $ mypy app/services/parser.py --config-file=mypy.ini
  Success: no issues found in 1 source file
  ```

- [x] **ãƒªãƒ³ãƒˆï¼ˆflake8ï¼‰**: ã‚¨ãƒ©ãƒ¼ãªã—
  ```bash
  $ flake8 app/services/parser.py
  (å‡ºåŠ›ãªã— - ã‚¨ãƒ©ãƒ¼ãªã—)
  ```

- [x] **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆBlackï¼‰**: é©åˆ
  ```bash
  $ black --check app/services/parser.py
  All done! âœ¨ ğŸ° âœ¨
  1 file would be left unchanged.
  ```

- [x] **ã‚¤ãƒ³ãƒãƒ¼ãƒˆé †åºï¼ˆisortï¼‰**: é©åˆ
  ```bash
  $ isort --check-only app/services/parser.py
  (å‡ºåŠ›ãªã— - æ­£ã—ã„é †åº)
  ```

## ğŸ“Š å®Ÿè£…çµ±è¨ˆ

- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 2ãƒ•ã‚¡ã‚¤ãƒ«
  - `app/services/__init__.py`: 4è¡Œ
  - `app/services/parser.py`: 169è¡Œï¼ˆdocstringå«ã‚€ï¼‰
- **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 2ãƒ•ã‚¡ã‚¤ãƒ«
  - `tests/fixtures/sample_talk.txt`: 21è¡Œï¼ˆå®Ÿãƒ‡ãƒ¼ã‚¿ï¼‰
  - `tests/unit/test_parser.py`: 289è¡Œ
- **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•°**: 15ãƒ†ã‚¹ãƒˆ
- **ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸**: 97%
- **ç·ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆæ•°**: 71ï¼ˆservices/__init__.py + parser.pyï¼‰

## ğŸ” å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ

### 1. å®Ÿéš›ã®LINEã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼ã¸ã®å¯¾å¿œ
- ã‚¿ãƒ–åŒºåˆ‡ã‚Šå½¢å¼ã®æ­£ç¢ºãªè§£æ
- æ—¥æœ¬èªæ›œæ—¥ï¼ˆæœˆç«æ°´æœ¨é‡‘åœŸæ—¥ï¼‰ã‚’å«ã‚€æ—¥ä»˜è¡Œã®å‡¦ç†
- ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆ`[LINE] <ãƒˆãƒ¼ã‚¯å>ã®ãƒˆãƒ¼ã‚¯å±¥æ­´`ï¼‰ã¨ä¿å­˜æ—¥æ™‚è¡Œã®ã‚¹ã‚­ãƒƒãƒ—

### 2. å …ç‰¢ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ä¸æ­£ãªæ—¥ä»˜ãƒ»æ™‚åˆ»ã®ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã‚’`try-except`ã§ã‚­ãƒ£ãƒƒãƒ
- å„ç¨®é™¤å¤–æ¡ä»¶ã‚’æ®µéšçš„ã«ãƒã‚§ãƒƒã‚¯ï¼ˆæ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ï¼‰
- æœ€å°è¦ç´ æ•°ã®ãƒã‚§ãƒƒã‚¯ï¼ˆã‚¿ãƒ–åŒºåˆ‡ã‚ŠãŒä¸ååˆ†ãªè¡Œã‚’é™¤å¤–ï¼‰

### 3. ãƒ¡ã‚¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åŒ…æ‹¬çš„é™¤å¤–
- 14ç¨®é¡ã®ãƒ¡ã‚¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®šç¾©
- æ­£è¦è¡¨ç¾ã®äº‹å‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆ`re.compile(..., re.IGNORECASE)`ï¼‰ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„æŸ”è»Ÿãªæ¤œç´¢

### 4. å‹å®‰å…¨æ€§
- å…¨ã¦ã®é–¢æ•°ã«å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å®Œå‚™
- `Message`ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®å‹ä¿è¨¼
- `datetime | None`ã€`list[Message]`ç­‰ã®æ˜ç¤ºçš„ãªè¿”ã‚Šå€¤å‹

### 5. ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸
- æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ãƒ»å¢ƒç•Œå€¤ã®ç¶²ç¾…çš„ãªãƒ†ã‚¹ãƒˆ
- å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ†ã‚¹ãƒˆ
- å†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰ã®å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ†ã‚¹ãƒˆï¼‰

## ğŸ› ä¿®æ­£å†…å®¹ï¼ˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã«ç™ºè¦‹ï¼‰

### Issue 1: ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ•ã‚¡ã‚¤ãƒ«ã®æœŸå¾…å€¤èª¤ã‚Š
- **å•é¡Œ**: ãƒ†ã‚¹ãƒˆã§æœŸå¾…å€¤ãŒ10ä»¶ã ã£ãŸãŒå®Ÿéš›ã¯11ä»¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè§£æã•ã‚ŒãŸ
- **åŸå› **: ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ã‚’æ­£ç¢ºã«ã‚«ã‚¦ãƒ³ãƒˆã—ã¦ã„ãªã‹ã£ãŸ
- **ä¿®æ­£**: ãƒ†ã‚¹ãƒˆã®æœŸå¾…å€¤ã‚’11ä»¶ã«ä¿®æ­£

### Issue 2: ä¸æ­£ãªæ™‚åˆ»ã§ã®ValueErrorã‚¯ãƒ©ãƒƒã‚·ãƒ¥
- **å•é¡Œ**: 25:00ç­‰ã®ä¸æ­£ãªæ™‚åˆ»ã§`datetime.replace()`ãŒ`ValueError`ã‚’ç™ºç”Ÿã•ã›ã¦ã„ãŸ
- **åŸå› **: `datetime.replace(hour=25, ...)`ã¯ç¯„å›²å¤–ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
- **ä¿®æ­£**: `try-except`ãƒ–ãƒ­ãƒƒã‚¯ã§`ValueError`ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦`None`ã‚’è¿”ã™ã‚ˆã†ã«å¤‰æ›´
- **è©²å½“ã‚³ãƒ¼ãƒ‰**:
  ```python
  try:
      message_datetime = current_date.replace(hour=hour, minute=minute)
  except ValueError:
      # ä¸æ­£ãªæ™‚åˆ»ï¼ˆ25:00ãªã©ï¼‰ã®å ´åˆã¯Noneã‚’è¿”ã™
      return None
  ```

### Issue 3: ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®è¦‹ç›´ã—
- **å¤‰æ›´**: `test_parse_invalid_time_format`ã‚’æœ‰åŠ¹ãªæ™‚åˆ»ï¼ˆ23:59ï¼‰ã‚’ä½¿ç”¨ã—ãŸãƒ†ã‚¹ãƒˆã«å¤‰æ›´
- **ç†ç”±**: ä¸æ­£ãªæ™‚åˆ»ã¯å®Ÿè£…ã§Noneã‚’è¿”ã™ãŸã‚ã€åˆ¥é€”ãƒ†ã‚¹ãƒˆã™ã‚‹å¿…è¦ãŒãªããªã£ãŸ

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPR#5ã¸ã®æº–å‚™ï¼‰

PR#4ã®å®Œäº†ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®æº–å‚™ãŒæ•´ã„ã¾ã—ãŸï¼š

- [x] LINEãƒˆãƒ¼ã‚¯å±¥æ­´ã®æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿å¤‰æ›
- [x] `Message`ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã®å®šç¾©
- [x] æ—¥æœ¬èªã‚’å«ã‚€è¤‡é›‘ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®è§£æãƒ­ã‚¸ãƒƒã‚¯

æ¬¡ã®PR#5ã§ã¯ã€ã“ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã®å‡ºåŠ›ï¼ˆ`list[Message]`ï¼‰ã‚’å…¥åŠ›ã¨ã—ã¦ã€MeCabã«ã‚ˆã‚‹å½¢æ…‹ç´ è§£æã‚’å®Ÿè£…ã—ã¾ã™ï¼š
- `app/services/morphological.py`ã®å®Ÿè£…
- `MorphologicalAnalyzer`ã‚¯ãƒ©ã‚¹
- å“è©ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½
- æ–‡å­—æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [SPEC.md - Section 5.1: LINEãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ‘ãƒ¼ã‚µãƒ¼](../SPEC.md#51-lineãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ‘ãƒ¼ã‚µãƒ¼-servicesparserpy)
- [SPEC.md - Section 8: å®Ÿè£…è¨ˆç”» - Phase 2: PR#4](../SPEC.md#pr4-lineãƒˆãƒ¼ã‚¯å±¥æ­´ãƒ‘ãƒ¼ã‚µãƒ¼ã®å®Ÿè£…)
- [ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„.md](../ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„.md)

## ğŸ‘¥ ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã«ã¯ä»¥ä¸‹ã®ç‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

1. **æ­£ç¢ºæ€§**: å®Ÿéš›ã®LINEã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼ã«æ­£ã—ãå¯¾å¿œã—ã¦ã„ã‚‹ã‹
2. **å …ç‰¢æ€§**: ä¸æ­£ãªãƒ‡ãƒ¼ã‚¿ãƒ»ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã«å¯¾ã—ã¦é©åˆ‡ã«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¦ã„ã‚‹ã‹
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å¤§é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ10,000ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ã§ã‚‚é©åˆ‡ã«å‹•ä½œã™ã‚‹ã‹
4. **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: ä¸»è¦ãªãƒ‘ã‚¹ãŒå…¨ã¦ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆ97%é”æˆï¼‰
5. **ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„**: PEP8ã€Google Styleã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç‹¬è‡ªãƒ«ãƒ¼ãƒ«ã«æº–æ‹ ã—ã¦ã„ã‚‹ã‹
